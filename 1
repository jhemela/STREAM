'exec(%matplotlib inline)'
import stream as st
st.__version__
adata=st.read(file_name='./filtered_gene_bc_matrices/hg19/matrix.mtx',file_format='mtx')


read in cell labels and label colorÂ¶
if cell label file or cell color file is not provided, please simply run:

'unknown' will be added as the default label for all cells
st.add_cell_labels(adata)

'random color will be generated for each cell label
st.add_cell_colors(adata)

In [5]:
st.add_cell_labels(adata,file_name='./cell_label.tsv.gz')
st.add_cell_colors(adata,file_name='./cell_label_color.tsv.gz')
other useful preprocessing steps when dealing with raw-count data
Normalize gene expression based on library size
st.normalize_per_cell(adata)

Logarithmize gene expression
st.log_transform(adata)

Remove mitochondrial genes
st.remove_mt_genes(adata)

Filter out cells
st.filter_cells(adata)

Filter out genes

In [6]:
st.filter_genes(adata,min_num_cells = max(5,int(round(adata.shape[0]*0.001))),
                min_pct_cells = None,expr_cutoff = 1)
Filter genes based on min_num_cells
After filtering out low-expressed genes: 
1656 cells, 4762 genes
In [ ]:

check parameters
st.select_variable_genes?

Please check if the blue curve fits the points well.
If not, try to lower the parameter 'loess_frac' (By default, loess_frac=0.1) until the blue curve fits well.

e.g. st.select_variable_genes(adata,loess_frac=0.01)

In [7]:
st.select_variable_genes(adata)
